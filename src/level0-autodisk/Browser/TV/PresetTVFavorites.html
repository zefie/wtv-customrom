<html>
<body bgcolor=#000000>
<script language="JavaScript" src="file://Disk/Browser/DiskFlash/tvhtmls/pageUtils.js">
	var pageParams = parsePageParams();

	function onLoadPage()
	{
			// add the favorites set and move on to the listings page
			// before this page has a chance to draw...
		var channelArray = null;
		switch (pageParams.favName) {
			case "Movie":
				channelArray = new Array(130, 131, 132, 300, 301, 302, 303, 304, 305, 310, 311, 312, 318, 319, 320, 322, 327, 328, 332, 333, 340, 342, 350, 351);
				break;

			case "News":
				channelArray = new Array(200, 202, 205, 206, 208, 209, 210, 212, 213);
				break;

			case "Sports":
				channelArray = new Array(140, 142, 143, 144, 153, 401, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 430, 432, 434, 435, 436, 626);
				break;

			case "Dish on Demand":
				channelArray = new Array(500, 501, 502, 503, 504, 505, 506, 507, 509, 510, 511);
				break;

			case "Childrens":
				channelArray = new Array(169, 171, 172, 173, 174, 176);
				break;

			case "Family":
				channelArray = new Array(170, 178, 180, 182, 184, 191);
				break;

			case "Music":
				channelArray = new Array(160, 161, 162, 166, 620, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 979);
				break;

			default:
				break;
		}

		if (channelArray != null && addPresetFavorites(pageParams.favName, channelArray)) {
			document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesListings.html";
		} else
			history.back();
	}

	function addPresetFavorites(favName, channelArray)
	{
		var channelCount = 0;
		var channel;
		var groupCount;
		var groupIndex;
		var isNewGroup;

		if (favName != null && channelArray != null && channelArray.length > 0) {
			groupCount = TVFavorites.getGroupCount();
			groupIndex = -1;
			isNewGroup = false;

				// look for an existing group
			for (var i = 0; i < groupCount && groupIndex == -1; i++) {
				if (TVFavorites.getGroupName(i) == favName)
					groupIndex = i;
			}

				// no existing group, create a new one
			if (groupIndex == -1) {
				groupIndex = TVFavorites.addGroup(favName);
				isNewGroup = true;
			}

			if (groupIndex != -1) {
				var saveGroupIndex = TVFavorites.getCurrentGroup();
				TVFavorites.setCurrentGroup(groupIndex);

					// add the channels
				for (var c = 0; c < channelArray.length; c++) {
					channel = channelArray[c];
					if (TVController.isChannelEnabled(channel)) {
						TVFavorites.setFavoriteChannel(channel, true);
						channelCount++;
					}
				}

					// if we created a new group, but didn't add any channels, remove it
				if (isNewGroup && channelCount == 0) {
					TVFavorites.removeGroup(groupIndex);
					TVFavorites.setCurrentGroup(saveGroupIndex);
				}

			}
		}

		return channelCount > 0;
	}


	onLoadPage();

</script>
</body>
</html>