<html>
<head>
<title>TV Listings Index</title>
<display noscroll>

<link rel="StyleSheet" type="text/css" href="TVListingsOptions.css">

<script language="JavaScript">
	function submitForm()
	{
		document.tvListingsForm.submit();
	}

	function updateChannel()
	{
		var channel = TVController.channel;

		document.channelText.channel = channel;
		document.channelText.network = TVDatabase.getNetworkOrCallSign(channel);
	}

	function gotoFavorites()
	{
		var groupCount = TVFavorites.getGroupCount();
		if (groupCount > 0) {
			if (groupCount > 1)
				document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesIndex.html";
			else
				document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesListings.html";
		} else
			document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesSetup.html?skipBack=true";
	}

	function setupFavorites()
	{
		document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesSetup.html";
	}

	function handleDishLogoError()
	{
			// if we failed to load the dishLogo from whatever reason, hide it
		document.dishLogo.visibility = "hidden";
	}

	function onLoadPage()
	{
		if (TVFavorites.hasListingsSupport)
			document.favoritesButton.visibility = "visible";

		updateChannel();
	}

</script>
</head>
<body bgcolor=#1c2438 background="file://rom/tvimages/StripePatternTVListings.gif"
		text=#cbcbcb link=#4489a8 hspace=0 vspace=0 fontsize=large onLoad="onLoadPage();">

	<div id=banner>
		<table cellspacing=0 cellpadding=0 cellborder=0>
			<tr><td background="file://ROM/tvimages/TVListingsShadowLogo.gif" width=104 height=80 valign=top align=left>
					<spacer type=block width=11 height=11><br>
					<spacer type=block width=10 height=1>
					<a href="client:showtvhome"><img src="file://ROM/Cache/WebTVLogoJewel.gif" width=87 height=67></a>
				<td width=456 height=80 valign=top align=center>
					<img src="file://ROM/tvimages/TVListingsBanner.gif" width=456 height=50><br>
					<img src="file://ROM/tvimages/Shadow_Horizontal.gif" width=456 height=6>
		</table>
	</div>

	<div id=viewtitle>
		<font size=+2 color=#ffcf69><shadow>View TV Listings</shadow></font>
	</div>

<script language="JavaScript">
	var viewLinkCount = 0;

	function writeViewLink(linkText, linkURL, linkOnClick)
	{
		viewLinkCount++;
		var onClickMarkup;

		if (linkOnClick != null && linkOnClick.length > 0)
			onClickMarkup = "onClick='" + linkOnClick + "'";
		else
			onClickMarkup = "";

		document.write(
			"<div id=arrow" + viewLinkCount + ">" +
				"<img src=file://Disk/Browser/DiskFlash/tvimages/TOCArrows.gif width=32 height=31>" +
			"</div>" +
			"<div id=tvListingsView" + viewLinkCount + ">" +
				"<a href='" + linkURL +  "' " + onClickMarkup + ((viewLinkCount == 1) ? " selected " : "") + "> " +
					"<font size=-1 color=#cccccc>" + linkText + "</font></a>" +
			"</div>"
			);
	}

	writeViewLink("For today", "client:showtvlistings?time=today", "");
	if (TVFavorites.hasListingsSupport)
		writeViewLink("By favorite channels", "client:donothing", "gotoFavorites();");
	writeViewLink("By day and time", "client:showtvlistings?time=editDay", "");

</script>

	<div id=searchtitle>
		<font size=+2 color=#ffcf69><shadow>Search TV Listings</shadow></font>
	</div>

	<div id=arrow4>
		<img src=file://Disk/Browser/DiskFlash/tvimages/TOCArrows.gif width=32 height=31>
	</div>

	<div id=search>
		<a href=file://Disk/Browser/DiskFlash/tvhtmls/Search/TVSearch.html>
			<font size=-1 color=#cccccc>
				By program title<br>
				or category
			</font>
		</a>
	</div>


	<div id=tvwindow>
		<!-- invoke TV Window script -->
		<script language="JavaScript" src="TVWindow.js">
			var tvCellAttributes = "href=client:showtvfullscreen";
			var tvDisplayAttributes = "channelDisplayId=channelText onChannelChange='updateChannel();'";
			var tvChannelAttributes = "id=channelText text=#506ba0 halign=right";
			var tvFontAttributes = "size=-2 color=#506ba0";

			writeTVWindow(true, tvDisplayAttributes, tvCellAttributes, tvChannelAttributes, tvFontAttributes);
		</script>
	</div>

<form id=tvListingsForm action=client:tvlistings>
	<div id=browse>
		<table cellspacing=0 cellpadding=0>
			<tr><td abswidth=22>
				<td abswidth=32 valign=top>
					<input type=checkbox name=browse value=true checked=&tv-browse; onClick="submitForm();">
				<td valign=top>
					<spacer type=vertical height=6><br>
					<font size=-2 color=#6cb18a>
						Stay on channel while<br>
						<spacer type=vertical height=14>
						browsing listings
					</font>
		</table>
	</div>

	<div id=favoritesButton>
		<font size=-1 color=#ffcf69><shadow>
			<input type=submit value="Set Up Favorites"
				usestyle width=180 action="" onClick="setupFavorites();"
				borderimage=file://ROM/tvimages/TVButtonBorder.bif>
		</shadow></font>
	</div>

	<div id=doneButton>
		<font size=-1 color=#ffcf69><shadow>
			<input type=submit value=Done name=Done
				usestyle width=130 action=client:goback
				borderimage=file://ROM/tvimages/TVButtonBorder.bif>
		</shadow></font>
	</div>

</form>
</body>
</html>
