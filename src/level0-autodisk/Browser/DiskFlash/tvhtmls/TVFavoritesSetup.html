<html>
<head>
<title>TV Favorites Setup</title>
<display nomapscroll>
<style type="text/css">
#banner {
	position: absolute;
	top: 0;
	left: 0;
	width: 560;
	height: 80;
}

#title {
	position: absolute;
	top: 107;
	left: 65;
	width: 291;
	height: 27;
}

#explain {
	position: absolute;
	top: 147;
	left: 65;
	width: 215;
}

#favoritesTable {
	position: absolute;
	top: 139;
	left: 312;
}

#addButton {
	position: absolute;
	top: 373;
	left: 258;
	width: 137;
	height: 35;
}

#doneButton {
	position: absolute;
	top: 373;
	left: 407;
	width: 137;
	height: 35;
}
#MSNLogo {
	position: absolute;
	top: 7;
	left: 10;
	width: 87;
}

</style>
<script language="JavaScript" src="pageUtils.js">
	var groupCount = TVFavorites.getGroupCount();
	var isEmpty = (groupCount == 0);
	var isFull = (groupCount == 8);

	function editFavorite(groupIndex)
	{
		TVFavorites.setCurrentGroup( groupIndex );
		document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesEditor.html";
	}

	function handleAddListingButton()
	{
		document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesAdd.html";
	}
</script>
</head>
<body bgcolor=#1c2438 background="file://rom/tvimages/StripePatternTVListings.gif"
		text=#989898 link=#6cb18a vlink=#6cb18a hspace=0 vspace=0 fontsize=large>

<form id=tvForm>

<div id=banner>
<table cellspacing=0 cellpadding=0 cellborder=0>
	<tr><td background="file://ROM/tvimages/TVListingsShadowLogo.gif" width=104 height=80 valign=top align=left>
			<spacer type=block width=11 height=11><br>
			<spacer type=block width=10 height=1>
		    <a href="client:showtvhome"><div id=MSNLogo><img src="file://ROM/tvimages/WebTVPlusJewelLogo.gif" ></div></a>
		<td width=456 height=80 valign=top align=center>
			<img src="file://ROM/tvimages/TVListingsBanner.gif" width=456 height=50><br>
			<img src="file://ROM/tvimages/Shadow_Horizontal.gif" width=456 height=6>
</table>
</div>

<div id=title>
	<font size=+2 color=#ffcf69><shadow>Set up favorites lists</shadow></font>
</div>

<div id=explain>
	<spacer type=vertical height=16>
	<font size=-1>
	<script language="JavaScript">
	if (!isEmpty) {
		document.write(
			"Choose a list to change it.<br>" + 
			"You can pick channels, change the list's name,<br>or remove the list."
			);

		if (!isFull)
			document.write(
				"<p>To set up a new list<br>of favorite channels choose <b>Add List</b>."
				);
	} else
		document.write(
			"To set up and name a list of favorite channels choose <b>Add List</b>."
			);
	</script>
</div>

<div id=favoritesTable>
	<table cellspacing=0 cellpadding=0>
	<script language="JavaScript">

	if (isEmpty) {
		document.write(
			"<spacer type=vertical height=12><br>" +
			"<font size=-2 color=#6cb18a><i>" +
			"<b>TIP</b>: Setting up lists of<br>favorite channels can make it<br>easier to browse TV Listings." +
			"<p>For example you can make<br>one favorites list for <b>Sports</b><br>channels, another list for<br><b>Movie</b> " +
			"channels and another<br>for <b>News</b> channels." +
			"</i></font>"
			);
	} else {
		// build list of favorite group names

		var groupName;
		var currentGroup = TVFavorites.getCurrentGroup();
		var selected;

		for ( var i = 0; i < groupCount; i++ ) {
			groupName = TVFavorites.getGroupName(i);
			if ( groupName != null && groupName != "" ) {
				selected = ( currentGroup == i ) ? "selected" : "";
				groupName = makeStringHTMLProof(groupName);
				document.write(
					"<tr><td valign=top>" +
						"<table cellspacing=0 cellpadding=0>" +
							"<tr><td maxlines=1 valign=top abswidth=240>" +
								"<spacer type=block width=10 height=22" +
								"<img src=file://Disk/Browser/DiskFlash/tvimages/Arrow_Green.gif width=7 height=13><spacer type=horizontal width=7>" +
								"<a " + selected + " href=client:donothing onClick='editFavorite(" + i + ");'>" +
									"<font size=-1>" + groupName + "</font></a>" +
						"</table>"
					);
			}
		}
	}

	</script>
	</table>
</div>

<div id=addButton>
	<font size=-1 color=#ffcf69><shadow>
	<script language="JavaScript">
	if (!isFull) {
		var buttonAttributes = isEmpty ? "selected" : "";

		if (buttonAttributes != null)
			document.write(
				"<input type=submit value='Add List' onClick='handleAddListingButton()' " + buttonAttributes +
					" action='' usestyle width=137 borderimage='file://ROM/tvimages/TVButtonBorder.bif'>"
				);
	}
	</script>
	</shadow></font>
</div>

<div id=doneButton>
	<font size=-1 color=#ffcf69><shadow>
	<input type=submit value=Done name=Done
		usestyle width=137 action="" onClick="history.back();"
		borderimage=file://ROM/tvimages/TVButtonBorder.bif>
	</shadow></font>
</div>
</form>
</body>
</html>
