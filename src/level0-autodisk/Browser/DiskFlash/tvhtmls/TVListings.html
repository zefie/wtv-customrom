<html>
<head>
	<title>TV Listings</title>
	<display nomapscroll noTVInfoOptions useHiddenTVInfo noSaveFormData>

	<script language=JavaScript src="TVListingsAccess.js">
	var isBrowsing = TVController.isListingsBrowseMode;

	function showProgram(channel, time, isNowShowing)
	{
		hideAd();

		if ( isBrowsing ) {
			if ( !isNowShowing )
				document.tv.alt = TVDatabase.getProgramStatus(channel, time, 1);

			if (navigator.isTVAccessSupported)
				accessStatus_Update(channel, time);
		} else {
			document.tv.time = time;

			if ( !isNowShowing ) {
			  document.tv.alt = TVDatabase.getProgramStatus(channel, time, 1);

			  document.tv.isActive = false;			    
                        }

			if (channel != document.tv.channel) {
				TVController.channel = channel;		// Only necessary when video is inactive.
				document.tv.channel = channel;
			}

			if ( isNowShowing )
			  {
			    document.tv.isActive = true;
			  }

			// ensure that we're not playing a blocked
			// channel's sound or are silent on an
			// unblocked channel.
			if (navigator.isTVAccessSupported) {
				if (TVAccess.isLocked() && 
				   ((TVAccess.isChannelLocked(channel)) || (TVAccess.isRatingsLocked(channel))))
						TVAccess.turnOffSound();
				else
						TVAccess.turnOnSound();
			}
		}

		url = TVDatabase.getStaticCrossoverLinkURL(channel, time);
		if ( url != null && url != "" )
			document.textForm.title.drawCrossoverMark = true;
		else 
			document.textForm.title.drawCrossoverMark = false;

		document.textForm.title.value = TVDatabase.getProgramTitle(channel, time);
		document.textForm.description.value = TVDatabase.getProgramDescription(channel, time);
		document.textForm.showtime.value = 
			TVDatabase.getProgramStartTime(channel, time) + " \x96 " + 
			TVDatabase.getProgramEndTime(channel, time);

		document.textForm.hiddenTime.value = time;
		document.textForm.hiddenChannel.value = channel;
	}

	function noInfo(channel)
	{
		hideAd();

		document.tv.time = 0;

		if (!isBrowsing) {
			if (channel != document.tv.channel)
				document.tv.channel = channel;

			document.tv.isActive = true;
		} else
			if (navigator.isTVAccessSupported)
				accessStatus_Hide();

		document.textForm.title.value = "No Information";
		document.textForm.description.value = "";
		document.textForm.showtime.value = "";
		document.textForm.hiddenTime.value = "";
		document.textForm.hiddenChannel.value = "";
		document.textForm.title.drawCrossoverMark = false;
	}

	function noInfoClick(channel)
	{
		document.location = "client:showtvfullscreen?tvchannel=" + channel;
	}

	function updateChannel()
	{
		var channel = TVController.channel;

		if (isBrowsing)
			document.channelText.channel = channel;
		document.channelText.network = TVDatabase.getNetworkOrCallSign(channel);
	}

	function showAd(adURLFragment)
	{
		document.adImage.src = "file://Disk/Browser/TV/Listings.DB/ads/" + adURLFragment + "/AdImage.gif";
		document.clockDisplay.visibility = "hidden";
		document.channelAccess.visibility = "hidden";
		document.titleField.visibility = "hidden";
		document.timeField.visibility = "hidden";
		document.descriptionField.visibility = "hidden";
		document.adDisplay.visibility = "visible";
	}

	function hideAd()
	{
		if (document.adDisplay.visibility == "visible") {
			document.adImage.src = "file://ROM/images/Spacer.gif";
			document.adDisplay.visibility = "hidden";
			document.clockDisplay.visibility = "visible";
			document.channelAccess.visibility = "visible";
			document.titleField.visibility = "visible";
			document.timeField.visibility = "visible";
			document.descriptionField.visibility = "visible";
		}
	}

	function adClick(adURLFragment)
	{
		document.location = "file://Disk/Browser/TV/Listings.DB/ads/" + adURLFragment + "/AdInfo.html";
	}

	function noAd()
	{
	}

	function noAdClick()
	{
	}

	function showFakeAd(adURLFragment)
	{
		document.adImage.src = "file://Disk/Browser/TV/Ads/" + adURLFragment;
		document.clockDisplay.visibility = "hidden";
		document.channelAccess.visibility = "hidden";
		document.titleField.visibility = "hidden";
		document.timeField.visibility = "hidden";
		document.descriptionField.visibility = "hidden";
		document.adDisplay.visibility = "visible";
	}

	function clickFakeAd(adURLFragment)
	{
		document.location = "file://Disk/Browser/TV/Ads/AdInfo.html";
	}

</script>

<style type="text/css">
	#tvWindow {
		position: absolute;
		top: 12;
		left: 9;
	}

	#channelDisplay {
		position: absolute;
		top: 145;
		left: 86;
		width: 176;
	}

	#clockDisplay {
		position: absolute;
		top: 11;
		left: 331;
		height: 17;
	}

	#channelAccess {
		position: absolute;
		top: 0;
		left: 197;
		width: 176;
		height: 34;
	}

	#titleField {
		position: absolute;
		top: 42;
		left: 202;
	}

	#timeField {
		position: absolute;
		top: 65;
		left: 202;
	}

	#descriptionField {
		position: absolute;
		top: 87;
		left: 202;
	}

	#tvListingsGrid {
		position: absolute;
		top: 173;
		left: 0;
	}

	#adDisplay {
		position: absolute;
		visibility: hidden;
		top: 14;
		left: 195;
	}
</style>
</head>

<body fontsize=medium bgcolor=102a27 text=d5d5d5 link=d5d5d5 vlink=cccccc vspace=0 hspace=0 onLoad="yakClock_Update();">

<table cellspacing=0 cellpadding=0>
	<tr><td absheight=173 abswidth=200 bgcolor=091917 gradcolor=0f2a27 gradangle=90>
</table>

<div id=tvWindow>
	<!-- invoke TV Window script -->
	<script language="JavaScript" src="TVWindow.js">
		var tvCellAttributes;
		var tvDisplayAttributes = "id='tv' channelDisplayId='channelText' onChannelChange='updateChannel();'";

		if ( isBrowsing ) {
			tvCellAttributes = "bgcolor=091918";
		} else {
			tvCellAttributes = "bgcolor=161d2d gradcolor=0b0b10 gradangle=90";
		}

		writeTVWindow(isBrowsing, tvDisplayAttributes, tvCellAttributes);
	</script>
</div>

<div id=channelDisplay>
	<font size=-1 color=4e7f64>
	<script language="JavaScript">
	if (!isBrowsing) {
		var channel = TVController.channel;
		var callLetters = TVDatabase.getNetworkOrCallSign(channel);

		if (callLetters == null || callLetters == "")
			callLetters = "&nbsp;";

		document.write("<channeldisplay channel=" + channel +
			" id=channelText text=4e7f64 halign=right invisible>");
	}
	</script>
</div>

<div id=clockDisplay align=right>
	<font size=-1 color=6a8cd2>
	<script language="JavaScript" src="yakClock.js">
		yakClock_Write();
	</script>
	</font>
</div>

<form name=textForm>

<!-- channel access message  -->
<div id=channelAccess>
	<script language="JavaScript" src="TVListingsAccess.js">
		if (isBrowsing && navigator.isTVAccessSupported)
			accessStatus_Write("textForm");
	</script>
</div>

<div id=titleField>
	<font size=+1 color=d5d5d5><shadow>
	<input id=title type=text size=29 width=306 usestyle nobackground border=0 nocursor noselect>
	</shadow></font>
	<script language=JavaScript>
		// if we are in A/B cable mode, display A/B indicator image

		var channelMode = TVController.channelMode;
		if ( channelMode != "All" ) {
			document.write(
				"<spacer type=horizontal width=4>" +
				"<img height=24 width=24 src=file://ROM/tvimages/Cable" + channelMode + "_On.gif>"
				);
		}
	</script>
</div>

<div id=timeField>
	<font size=-1 color=7aa995>
	<input id=showtime type=text size=29 width=330 usestyle nobackground border=0 nocursor noselect>
	</font>
</div>

<div id=descriptionField>
	<font size=-1 color=7aa995>
	<textarea id=description width=340 rows=4 usestyle nobackground border=0 nocursor noselect></textarea>
	</font>
</div>

<div id=adDisplay>
	<table cellspacing=0 cellpadding=0>
		<tr><td abswidth=352 absheight=122 align=center bgcolor=#000000>
			<img id=adImage src="file://ROM/images/Spacer.gif" width=350 height=120>
			<!embed id=adImage src="file://ROM/images/Spacer.gif" abswidth=350 absheight=120>
	</table>
	<spacer type=vertical height=8><br>
	<font size=-3 color=#6cb18a>
	<spacer type=horizontal width=234>ADVERTISEMENT
	</font>
</div>

<input type=hidden id=hiddenTime name=hiddenTime value="">
<input type=hidden id=hiddenChannel name=hiddenChannel value="">
</form>

<!-- ** WARNING: The tvtable MUST be the last element on this page to work    -->
<!-- **          around an outstanding problem with FrameDocument::RemoveText -->
<div id=tvListingsGrid>
	<table cellspacing=0 cellpadding=0>
		<tr><td abswidth=560 valign=top>
			<script language="JavaScript" src="pageUtils.js">
				var pageParams = parsePageParams();
				var timeString;

				if (pageParams.time == null) {
					var today = new Date();
					timeString = today.getTime();
				} else
					timeString = pageParams.time;

				document.write("<tvtable value=" + timeString + ">");
			</script>
	</table>
</div>
<!-- ** WARNING: No HTML elements allowed beyond this point!    -->
</body>
</html>
