<html>
<head>
<title>TV Favorites Editor</title>
<display nomapscroll>
<style type="text/css">
#banner {
	position: absolute;
	top: 0;
	left: 0;
	width: 560;
	height: 80;
}

#title {
	position: absolute;
	top: 89;
	left: 65;
}

#explain {
	position: absolute;
	top: 122;
	left: 65;
}

#tvWindow {
	position: absolute;
	top: 58;
	left: 363;
}

#channelDisplay {
	position: absolute;
	top: 166;
	left: 245;
	width: 120;
}

#channelTable {
	position: absolute;
	top: 187;
	left: 0;
}

#removeButton {
	position: absolute;
	top: 376;
	left: 15;
	width: 172;
	height: 35;
}

#renameButton {
	position: absolute;
	top: 376;
	left: 199;
	width: 172;
	height: 35;
}

#doneButton {
	position: absolute;
	top: 376;
	left: 413;
	width: 137;
	height: 35;
}

#stripes {
	position: absolute;
	top: 50;
	left: 450;
	width: 110;
	height: 137;
}

#MSNLogo {
	position: absolute;
	top: 7;
	left: 10;
	width: 87;
}

</style>
<script language="JavaScript" src="pageUtils.js">
	var pageParams = parsePageParams();
	var newGroupName = null;
	var curGroupName = TVFavorites.getGroupName(TVFavorites.getCurrentGroup());

	function checkNewGroup()
	{
		var groupCount;

		if (pageParams.newGroupName != null && pageParams.newGroupName.length > 0) {
			newGroupName = pageParams.newGroupName;

			if (newGroupName != curGroupName) {
				curGroupName = newGroupName;
				groupCount = TVFavorites.getGroupCount();

				for (groupIndex = 0; groupIndex < groupCount; groupIndex++) {
					var testName = TVFavorites.getGroupName(groupIndex);
					if (newGroupName == testName) {
						newGroupName = null;
						TVFavorites.setCurrentGroup(groupIndex);
						break;
					}
				}
			} else
				newGroupName = null;
		}
	}

	checkNewGroup();

	function addGroup(favName)
	{
		var groupIndex = TVFavorites.addGroup(favName);

		if (groupIndex != -1) {
			TVFavorites.setCurrentGroup(groupIndex);
			return true;
		} else
			return false;
	}

	function toggleChannel(channel)
	{
		if (newGroupName != null) {
			if (addGroup(newGroupName))
				newGroupName = null;
			else
				history.back();
		}

		if (newGroupName == null)
			TVFavorites.setFavoriteChannel(channel, !TVFavorites.isFavoriteChannel(channel));
	}

	function previewChannel(channel)
	{
		if (channel != -1 && channel != TVController.channel)
			TVController.channel = channel;
	}

	function isChannelChecked(channel)
	{
		return (newGroupName == null) ? TVFavorites.isFavoriteChannel(channel) : false;
	}

	function handleOnLoad()
	{
		var visibility;

		if (document.favChannelTable.scrollMaxHorizontal > 0)
			visibility = "visible";
		else
			visibility = "hidden";

		document.arrowLeft.visibility = visibility;
		document.arrowRight.visibility = visibility;

		if (pageParams.newGroup == "true" && newGroupName != null) {
			document.removeButton.visibility = "hidden";
			document.renameButton.visibility = "hidden";
		}
	}

	function handleRemoveButton()
	{
		document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesRemove.html";
	}

	function handleRenameButton()
	{
		document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesName.html";
	}

	function handleDoneButton()
	{
		if (pageParams.newGroup == "true") {
			if (newGroupName == null)
				document.location = "file://Disk/Browser/DiskFlash/tvhtmls/TVFavoritesListings.html";
			else
				history.back();
		} else
			history.go("TVFavoritesSetup");
	}
</script>
</head>
<body text=#989898 hspace=0 vspace=0 fontsize=large noscroll onLoad="handleOnLoad();" bgcolor=#1c2438>

<form name=tvFavoritesForm>

<div id=banner>
	<table cellspacing=0 cellpadding=0 cellborder=0>
		<tr><td background="file://ROM/tvimages/TVListingsShadowLogo.gif" width=104 height=80 valign=top align=left>
				<spacer type=block width=11 height=11><br>
				<spacer type=block width=10 height=1>
				 <a href="client:showtvhome"><div id=MSNLogo><img src="file://ROM/tvimages/WebTVPlusJewelLogo.gif" ></div></a>
			<td width=456 height=80 valign=top align=center>
				<img src="file://ROM/tvimages/TVListingsBanner.gif" width=456 height=50><br>
				<img src="file://ROM/tvimages/Shadow_Horizontal.gif" width=456 height=6>
	</table>
</div>

<div id=title>
	<table cellspacing=0 cellpadding=0>
		<tr><td maxlines=1 valign=top abswidth=300>
			<font size=+2 color=#ffcf69><shadow>
				<script language="JavaScript">
					var nameSuffix;

					if (curGroupName.toLowerCase().indexOf("favorite") == -1)
						nameSuffix = " favorites";
					else
						nameSuffix = "";
					curGroupName = makeStringHTMLProof(curGroupName);

					document.write( curGroupName + nameSuffix );
				</script>
			</shadow></font>
	</table>
</div>

<div id=explain>
	<font size=-1>
	Mark channels to include<br>in favorites list.
	</font>
</div>

<div id=stripes>
	<table cellpadding=0 cellspacing=0>
		<tr><td absheight=137 abswidth=110 background="file://ROM/tvimages/StripePatternTVListings.gif">
				<spacer width=10>
	</table>
</div>

<div id=tvWindow>
	<table cellspacing=0 cellpadding=0>
		<tr><td abswidth=10 absheight=3>
				<img src=file://ROM/tvimages/VideoBorder_TopLeft.gif width=10 height=3>
			<td abswidth=160 absheight=3>
				<img src=file://ROM/tvimages/VideoBorderEdge_Top.gif width=160 height=3>
			<td abswidth=10 absheight=3>
				<img src=file://ROM/tvimages/VideoBorder_TopRight.gif width=10 height=3>
		<tr><td abswidth=10 absheight=120>
				<img src=file://ROM/tvimages/VideoBorderEdge_Left.gif width=10 height=120>
			<td abswidth=160 absheight=120 align=right valign=top href=client:showtvfullscreen>
				<font size=-1 color=6a8dd3>
					<tv width=160 height=120 channelDisplayID=channelText>
				</font>
			<td abswidth=10 absheight=120>
				<img src=file://ROM/tvimages/VideoBorderEdge_Right.gif width=10 height=120>
		<tr><td abswidth=10 absheight=3>
				<img src=file://ROM/tvimages/VideoBorder_BotLeft.gif width=10 height=3>
			<td abswidth=160 absheight=3>
				<img src=file://ROM/tvimages/VideoBorderEdge_Bottom.gif width=160 height=3>
			<td abswidth=10 absheight=3>
				<img src=file://ROM/tvimages/VideoBorder_BotRight.gif width=10 height=3>
	</table>
</div>

<div id=channelDisplay>
	<font size=-1 color=4e7f64>
	<channeldisplay id=channelText text=4e7f64 halign=right invisible>
	</font>
</div>

<div id=channelTable>
	<table cellspacing=0 cellpadding=0>
		<tr><td width=560 height=2 bgcolor=#000000 transparency=70>
		<tr><td width=560 height=1 bgcolor=#101521>
	</table>
	<table cellspacing=0 cellpadding=0>
		<tr><td>
				<table cellspacing=0 cellpadding=0>
					<tr><td width=28 height=2 bgcolor=#2b303a>
					<tr><td height=170 bgcolor=#101521 align=center bgshadow>
							<div id=arrowLeft>
							<img src="file://Disk/Browser/DiskFlash/tvimages/ArrowLeft.gif">
							</div>
					<tr><td height=2 bgcolor=#0b0e17>
					<tr><td height=1 bgcolor=#101521>
				</table>
			<td>
				<tvChannelTable id=favChannelTable bgcolor=#101521 selected>
			<td>
				<table cellspacing=0 cellpadding=0>
					<tr><td width=28 height=2 bgcolor=#2b303a>
					<tr><td height=170 bgcolor=#101521 align=center bghighlight>
							<div id=arrowRight>
							<img src="file://Disk/Browser/DiskFlash/tvimages/ArrowRight.gif">
							</div>
					<tr><td height=2 bgcolor=#0b0e17>
					<tr><td height=1 bgcolor=#101521>
				</table>
	</table>
	<table cellspacing=0 cellpadding=0>
		<tr><td width=560 height=2 bgcolor=#FFFFFF transparency=88>
	</table>
</div>

<div id=removeButton>
	<font size=-1 color=#ffcf69><shadow>
	<input type=submit value="Remove List" submitform action="" onClick="handleRemoveButton();" width=172 usestyle borderImage=file://ROM/tvimages/TVButtonBorder.bif>
	</shadow></font>
</div>

<div id=renameButton>
	<font size=-1 color=#ffcf69><shadow>
	<input type=submit value="Rename List" submitform action="" onClick="handleRenameButton();" width=172 usestyle borderImage=file://ROM/tvimages/TVButtonBorder.bif>
	</shadow></font>
</div>

<div id=doneButton>
	<font size=-1 color=#ffcf69><shadow>
	<input type=submit value="Done" submitform action="" onClick="handleDoneButton();" width=137 usestyle borderImage=file://ROM/tvimages/TVButtonBorder.bif>
	</shadow></font>
</div>
</form>
</body>
</html>
