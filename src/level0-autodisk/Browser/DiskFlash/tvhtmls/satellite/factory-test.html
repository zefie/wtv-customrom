<html>
<display nomapscroll lockpage>
<head>
<title>Lock Channels</title>
<style type="text/css">
#title {
	position: absolute;
	top: 20;
	left: 20;
}

#tvWindow {
	position: absolute;
	top: 52;
	left: 205;
}

#renameButton {
	position: absolute;
	top: 376;
	left: 266;
	width: 137;
	height: 35;
}

#doneButton {
	position: absolute;
	top: 376;
	left: 413;
	width: 137;
	height: 35;
}

#avThru {
	position: absolute;
	top: 90;
	left: 30;
	width: 160;
	height: 35;
}

#micThru {
	position: absolute;
	top: 140;
	left: 30;
	width: 160;
	height: 35;
}

#LEDToggle {
	position: absolute;
	top: 190;
	left: 30;
	width: 160;
	height: 35;
}

#BlastButton {
	position: absolute;
	top: 250;
	left: 30;
	width: 120;
	height: 35;
}

#infoButtonText {
	position: absolute;
	top: 320;
	left: 30;
}

#smartCardText {
	position: absolute;
	top: 350;
	left: 30;
}

#micJackText {
	position: absolute;
	top: 380;
	left: 30;
}


</style>
<script language="JavaScript">

	function updateInfoButton()
	{
		var butt = "Front Panel Info Button: ";

		if ( Satellite.frontPanelInfoButton )
			butt += "Pressed";
		else
			butt += "Released";			
		
		document.factoryTestForm.infoButton.value = butt;
	}

	function updateSmartCard()
	{
		var cardPresent = "WebTV SmartCard: ";

		if ( Satellite.smartCardSwitch )
			cardPresent += "Inserted";
		else
			cardPresent += "Removed";			
		
		document.factoryTestForm.smartCard.value = cardPresent;
	}

	function updateMicJack()
	{
		var micPresent = "Mic Jack: ";

		if ( AudioCapture.micPluggedIn )
			micPresent += "Plug Inserted";
		else
			micPresent += "Empty";			
		
		document.factoryTestForm.micJack.value = micPresent;
	}

	function handleDoneButton()
	{
		history.back();
	}

	function handleAVThru()
	{
		document.lockPage( false );

		if ( document.factoryTestForm.avThru.checked )
			document.location = "client:setvideo?source=video";
		else
			document.location = "client:setvideo?source=tuner";

		document.lockPage( true );
	}

	function handleMicThru()
	{
		document.lockPage( false );

		if ( document.factoryTestForm.micThru.checked )
			document.location = "client:setaudiopassthru?source=mic";
		else
			document.location = "client:setaudiopassthru?source=webtuner";

		document.lockPage( true );
	}

	var ledState;
	var updateLEDs;

	function updateLEDState()
	{
		document.lockPage( false );

		if ( updateLEDs )
		{
			if ( ledState == 0 )
				document.location = "client:setleds?power=off&connected=off&message=off";
			else 
				if ( ledState == 1 )
					document.location = "client:setleds?power=off&connected=off&message=on";
				else
					if ( ledState == 2 )
						document.location = "client:setleds?power=off&connected=on&message=off";
					else
						if ( ledState == 3 )
							document.location = "client:setleds?power=on&connected=off&message=off";

			ledState++;
			if ( ledState > 3 )
				ledState = 0;
		}
		
		document.lockPage( true );
	}

	function handleLEDToggle()
	{
		document.lockPage( false );

		if ( document.factoryTestForm.leds.checked )
			updateLEDs = 1;
		else
		{
			updateLEDs = 0;

			document.location = "client:setleds?power=on&connected=off&message=off";
		}

		document.lockPage( true );
	}

	function handleBlastButton()
	{
		document.lockPage( false );

		var dlay = 0;
		while ( dlay < 10000 )
			dlay++;

		var cnt = 0;
		while ( cnt < 10 )
		{
			document.location = "client:vcr?command=power";
			cnt++;
			dlay = 0;
			while ( dlay < 2000 )
				dlay++;
		}

		document.lockPage( true );
	}


	function handleOnLoad()
	{
		document.location = "client:setirblaster?device=vcr&deviceid=00000000&codeset=000";

		updateLEDs = 0;
		ledState = 0;

		updateInfoButton();
		updateSmartCard();
		updateMicJack();

		setInterval(updateInfoButton, 250);
		setInterval(updateSmartCard, 250);
		setInterval(updateMicJack, 250);
		setInterval(updateLEDState, 80);
	}


</script>
</head>
<body text=#989898 hspace=0 vspace=0 fontsize=large noscroll onLoad="handleOnLoad();" bgcolor=#21212e>

<form name=factoryTestForm>

<div id=title>
	<font size=+2 color=#ffcf69><shadow>Factory Tests</shadow></font>
</div>


<div id=tvWindow>
	<tv width=324 height=243>
</div>


<div id=doneButton>
	<font size=-1 color=#ffcf69><shadow>
	<input type=submit value="Done" submitform action="" onClick="handleDoneButton();" width=137 usestyle borderImage=file://ROM/tvimages/TVButtonBorder.bif>
	</shadow></font>
</div>

<div id=avThru>
	<input name=avThru type=checkbox bgcolor=#444444 onClick="handleAVThru();" checked=off offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
	&nbsp; <font size=-1 color=#6cb18a>A/V Passthru
</div>

<div id=micThru>
	<input name=micThru type=checkbox bgcolor=#444444 onClick="handleMicThru();" checked=off offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
	&nbsp; <font size=-1 color=#6cb18a>Mic Passthru
</div>

<div id=LEDToggle>
	<input name=leds type=checkbox bgcolor=#444444 onClick="handleLEDToggle();" checked=off offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
	&nbsp; <font size=-1 color=#6cb18a>Front LEDs
</div>

<div id=BlastButton>
	<font size=-1 color=#ffcf69><shadow>
	<input type=submit onClick="handleBlastButton();" action='' font=proportional width=135 value="IR Blast" borderImage="file://ROM/tvimages/TVButtonBorder.bif" usestyle>
	</shadow></font>
</div>


<div id=smartCardText>
	<font size=-1 color=#6cb18a><b>
	<textarea id=smartCard width=340 rows=4 usestyle nobackground border=0 nocursor noselect></textarea>
	</font>
</div>

<div id=micJackText>
	<font size=-1 color=#6cb18a><b>
	<textarea id=micJack width=340 rows=4 usestyle nobackground border=0 nocursor noselect></textarea>
	</font>
</div>

<div id=infoButtonText>
	<font size=-1 color=#6cb18a><b>
	<textarea id=infoButton width=340 rows=4 usestyle nobackground border=0 nocursor noselect></textarea>
	</font>
</div>


</form>
</body>
</html>
