<HTML>
<HEAD>
<TITLE>Games locking</TITLE>
<DISPLAY noscroll nologo nooptions noreconnectalert>
</HEAD>
<BODY>

<script language="JavaScript">
	var curRatingLimit = 0;
	var gamesLocked = true;

	function setState()
	{
		gamesLocked = TVAccess.isGamesLocked();
		curRatingLimit = TVAccess.getESRBRatingLimit();

		document.gameRatingForm.gamesLocked.checked = gamesLocked;

		var count = document.gameRatingForm.ESRBRatingLimit.length;
	
		if ( gamesLocked ) {
			// If all games are locked, always set the rest of the boxes to be checked.
			for (var i = 0; i < count; i++)
				document.gameRatingForm.ESRBRatingLimit[i].checked = (i >= curRatingLimit);
		}
		else {
			if (curRatingLimit != -1) {
				for (var i = 0; i < count; i++)
					document.gameRatingForm.ESRBRatingLimit[i].checked = (i >= curRatingLimit);
			}
		}
	}

	function internalUpdateLimit(ratingLimit)
	{
		var isChecked = !document.gameRatingForm.ESRBRatingLimit[ratingLimit].checked;
		var count = document.gameRatingForm.ESRBRatingLimit.length;
		for (var i = 0; i < count; i++)
			document.gameRatingForm.ESRBRatingLimit[i].checked = isChecked ? (i > ratingLimit) : (i >= ratingLimit);

		curRatingLimit = ratingLimit;
		if (isChecked) {
			curRatingLimit++;
			if (curRatingLimit >= count)
				curRatingLimit = -1;
		}
	}

	function updateLimit(ratingLimit)
	{
		// If we're tweaking the normal limit items, unlock the "Lock All" control.
		internalUpdateLockAll(false);
		internalUpdateLimit(ratingLimit);
	}

	function internalUpdateLockAll(locked)
	{
		// Either way, set the limit to 0.
		gamesLocked = locked;
		document.gameRatingForm.gamesLocked.checked = gamesLocked;
	}

	function updateLockAll()
	{
		// Either way, set the limit to 0.
		var lock = document.gameRatingForm.gamesLocked.checked;
		internalUpdateLockAll( lock );
		var count = document.gameRatingForm.ESRBRatingLimit.length;
		for (var i = 0; i < count; i++)
			document.gameRatingForm.ESRBRatingLimit[i].checked = true;
		curRatingLimit = -1;
	}

	function gotoNext()
	{
		TVAccess.setGamesLock(gamesLocked);
		TVAccess.setESRBRatingLimit(curRatingLimit);
		history.go("setup-locks");
	}

</script>

<link rel="StyleSheet" type="text/css" href="locking-styles.css">

<body bgcolor=#21212e background="file://rom/tvimages/Pattern_TVSettings.gif" text=#cbcbcb link=#4489a8 hspace=0 vspace=0
 onLoad="setState()" fontsize=large noscroll hideoptions>

<form name=gameRatingForm action="client:CAM">

	<div id=banner>
	<table cellspacing=0 cellpadding=0 cellborder=0>
		<tr><td background="file://rom/tvimages/ShadowLogo_Horizontal.gif" width=104 height=80 valign=top align=left>
				<spacer type=block WIDTH=11 HEIGHT=11><br>
				<spacer type=block WIDTH=10 HEIGHT=1>
	    		<a href="client:showtvhome"><div id=MSNLogo><img src="file://ROM/tvimages/WebTVPlusJewelLogo.gif" ></div></a>
			<td width=456 height=80 valign=top align=center>
				<img src="file://rom/tvimages/TVSettingsBanner.gif" width=456 height=50><br>
				<img src="file://rom/tvimages/Shadow_Horizontal.gif" width=456 height=6>
	</table>
	</div>

	<div id=contbutton>
		<font size=-1 color=#ffcf69><shadow>
			<input type=submit value=Continue name=Continue
				usestyle width=130 onclick="gotoNext();" selected
				borderimage="file://ROM/tvimages/TVButtonBorder.bif">
		</shadow></font>
	</div>

	<div id=title>
		<font size=+2 color=#ffcf69>Block games</font>
	</div>

	<div id=infoButton>
		<font size=-1 color=#ffcf69><shadow>
			<input type=submit value="Ratings Info" name=Info
				usestyle width=156 action="ratings/GameRatings_01.html"
				borderimage="file://ROM/tvimages/TVButtonBorder.bif">
		</shadow></font>
	</div>

	<div id=info>
		<font size=-1 color=989898>
			Mark which games<br>
			ratings to block.
			<p>Choose <b>Ratings Info</b> for complete descriptions.
			<p>If you want to block<br>
			playing <i>all</i> games<br>
			mark <b>Block all games</b>.
		</table>
	</div>

	<div id=checkbox>
		<table cellspacing=0 cellpadding=0>
		    <tr valign=top>
			<td><input name=gamesLocked type=checkbox bgcolor=#444444 checked=off onClick = "updateLockAll(); return false;" offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
			<td valign=center><font size=-1 color=#6cb18a>&nbsp;Block all games</font>
			<tr><td height=8>
			<tr valign=top>
			<td><input name=ESRBRatingLimit type=checkbox value=EC onClick="updateLimit(0); return false;" bgcolor=#444444 checked=off offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
			<td valign=center><font size=-1 color=#6cb18a>&nbsp;<b>EC</b> (early childhood)</font>
			<tr><td height=8>
			<tr valign=top>
			<td><input name=ESRBRatingLimit type=checkbox value=E onClick="updateLimit(1); return false;" bgcolor=#444444 checked=off offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
			<td valign=center><font size=-1 color=#6cb18a>&nbsp;<b>E</b> (everyone)
			</font>
			<tr><td height=8>
			<tr valign=top>
			<td><input name=ESRBRatingLimit type=checkbox value=T onClick="updateLimit(2); return false;" bgcolor=#444444 checked=off offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
			<td valign=center><font size=-1 color=#6cb18a>&nbsp;<b>T</b> (teen)</font>
			<tr><td height=8>
			<tr valign=top>
			<td><input name=ESRBRatingLimit type=checkbox value=M onClick="updateLimit(3); return false;" bgcolor=#444444 checked=off offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
			<td valign=center><font size=-1 color=#6cb18a>&nbsp;<b>M</b> (mature)</font>
			<tr><td height=8>
			<tr valign=top>
			<td><input name=ESRBRatingLimit type=checkbox value=AO onClick="updateLimit(4); return false;" nextdown="Done" bgcolor=#444444 checked=off offimage="file://ROM/tvimages/satellite/BlockBox.gif" onimage="file://ROM/tvimages/satellite/BlockedBox.gif">
			<td valign=center>
			<font size=-1 color=#6cb18a>&nbsp;<b>AO</b> (adults only)</font>
			<tr><td height=6>
			<tr valign=top>
			<td>
		</table>
	</div>
<input name=gameLockingSubmitted type=hidden value=yes>
</form>
</body>
</html>


