<html>

<head>
<title>Offline email</title>

<script src=file://ROM/JS/parameters.js></script>

<script src="MailUtilities.js">
// Load common mail utility functions
</script>

<script src="SyncUtilities.js">
// Load common mail utility functions
</script>

<script src="AddressUtilities.js">
// Load common address verification functions
</script>

<script src="FolderUtilities.js">
// Load common functions for managing email folders
</script>

<script src="AdUtilities.js">
// Load common functions for managing ads
</script>

<object id="Store" classid="clsid:000001C3-0C8A-11d2-BEEF-00A0C9AA0831" width=0 height=0></object>
<object id=Request classid="clsid:000001C6-0C8A-11d2-BEEF-00A0C9AA0831" width=0 height=0></object>

<script>
	// Global Variables
	var xmldoc						= NewXMLDocument();
	var gAlertIconURL				= "file://ROM/Cache/WebTVLogoJewel.gif";
	var gConfigXML					= NewXMLDocument();
	var gPathXML					= NewXMLDocument();

	var L_Disk_FileName				= "disk";
	var L_Paths_FileName			= "OffLineEmailPaths.xml";
	var L_2dot5BoxPaths_FileName	= "ROM/Email/"				+ L_Paths_FileName;	// for LC2.5 box
	var L_SimulatorPaths_FileName	= "AutoDisk/Browser/Email/"	+ L_Paths_FileName;	// for Simulator

	var gAppInfo;
	var gPath						= new Object();
	var gConfigInfo;
	var gConfig						= new Object();
	var gUserInfoXML				= NewXMLDocument();
	var gUserInfos;
	var gUserCount;
	var gCurrentUser				= 0;	// index of the current user
	var gServiceUsersXML			= NewXMLDocument();
	var gServiceUserInfos;
	var gServiceUserCount;

	// Define global variables. These are set after the user choose which user he is
	var gIsOfflineEmail				= true;
	var gIsFreeEmail				= false;
	var gUserInfo;
	var gEmailAddress;
	var gUserName;
	var gUserID;
	var gUserPasswd;
	var gBadLogin;
	var gBadLoginCnt;
	var gBadConnect;
	var gLastConnect;
	var gMaxInMsgs;
	var gMaxInDiskSpace;
	var gMaxOutMsgs;
	var gMaxOutDiskSpace;
	var gMaxInBoxMsgSize;
	var gMaxOutBoxMsgSize;
	var gFullInBox;
	var gFullOutBox;
	var gInFolder;
	var gOutFolder;
	var gDeletedFolder;
	var gInFolderStore;
	var gOutFolderStore;
	var gUsers;
	var gAddressBookXML				= NewXMLDocument();
	var gAddressEntries;
	var gLetter						= new Object();
	var gBoxLostMind				= false;			// NEED TO GET THIS FROM SOMEWHERE
	var gRequest					= newRequest();
	var gMaxUsers					= 6;
	var gReplyIncludeMsg			= false;
	var gCCMsg						= false;
	var gListAscending				= false;
	var gExtraStorage				= false;

	// Constants for CleanUpScroll page. Parameters don't seem to get passed to
	// IFRAME's, so I pass parameters through globals
	var kShowInBoxCmd				= 1;
	var kShowOutBoxCmd				= 2;
	var kShowDeletedBoxCmd			= 3;
	var gCleanUpCmd					= kShowInBoxCmd;

	// Localized strings shared between various frames
	var L_HelpButton_Text			= "Help";
	var L_AddressesButton_Text		= "Addresses";
	var L_ListButton_Text			= "Mail list";
	var L_DiscardButton_Text		= "Discard";
	var L_OutgoingButton_Text		= "Outgoing";
	var L_From_Text					= "From";
	var L_To_Text					= "To";
	var L_YesButton_Text			= "Yes";
	var L_NoButton_Text				= "No";
	var L_DiscardButton_Text		= "Discard";
	var L_DontDiscardButton_Text	= "Don't Discard";
	var L_Continue_Text				= "Continue";
</script>
</head>

<display nooptions notvaudio offlineemail showwhencomplete>

<frameset cols="100%" frameborder=0 framespacing=0 border=0 hspace=0 and vspace=0>
	<script>
		var startPage = "InitEmail.html?action=" + parameters.action;
		document.write("<frame src=" + startPage + " noresize name=MainFrameArea>");
	</script>
</frameset>
</html>
