<html>

<script src=file://ROM/JS/parameters.js></script>

<head>
	<link href="CommonStyles.css" rel=Stylesheet>

	<display fontsize="medium">
	<style>
	#passwdLabelText {
		position: absolute;
		top: 165;
		left: 64;
		right: 295;
		font:18pt;
		color:6cb18a;
		line-height:24pt;
		text-align:right;
	}
	#passwdValueText {
		position: absolute;
		top: 160;
		left: 155;
		font:18pt;
		color:ffcf69;
		line-height:24pt;
		width: 300;
	}
	#doneButton {
		position: absolute;
		top: 157;
		left: 404;
		width: 135;
		font:18pt;
		color:ffcf69;
		line-height:24pt;
		background-color: 191919;
	}
	</style>

	<script>
		window.message("top.gBadLogin " + top.gBadLogin
			+ " bad login: " + top.gUserInfo.getAttribute("BadLogin")
			+ " gBadLoginCnt: " + top.gBadLoginCnt);

		// Check to see if the user has a password
		var L_MainPage_Text = top.clientVersion() < 3 ? "ListMail.html" : "InitialAd.html";

		window.message("Main page " + L_MainPage_Text + " top.gUserPasswd " + top.gUserPasswd);

		if (top.gUserPasswd == "") {
			window.message("No password");
			WarnUser();	// if there's no password, go immediately to the mail list and skip the login
		} else {
			window.message("has a password of '", top.gUserPasswd, "'");
		}

		// Figure out what to show

		var doAction;

		if (top.gBadLoginCnt >= 1) {
			// shown on the first bad login attemp
			doAction = "firstbad";
		} else {
			// normal first chance login entry
			doAction = "login";
		}
		window.message("***Login state = " + doAction);

		function SetFields()
		{
			document.passwordform.passwd.value = "";

			document.passwordform.Done.value = top.L_Continue_Text;
		}

		function CheckPassword()
		{
			var userIndex = top.GetServiceUserIndex(top.gUserID);
			var user = WebTVUsers[userIndex];
		window.message("userIndex ", userIndex, " user.name ", user.name);

			if (!user.validatePassword(document.passwordform.passwd.value)) {
				var L_BadPasswd_Text = "The password you typed isn't correct. Plase type your password.";
				alertPriv(L_BadPasswd_Text, top.gAlertIconURL, top.L_Continue_Text);
				document.passwordform.passwd.value = "";
				document.passwordform.passwd.focus();
				return false;
			}
			window.message("FALLING OUT");
			top.WarnUser();
		}

	</script>

</head>

<print blackandwhite>

<body 
	bgcolor=172625 text="42BD52" link="189CD6"
	vlink="189CD6" fontsize="medium"
	vspace=0
	hspace=0
	onLoad="SetFields();">

<div id=topTVBannerBackground bgcolor=6D5A85>
</div>

<div id=topTVBanner>
	<img src=images/TVMailBanner.gif>
</div>

<div id=webTVJewel>
	<img src="file://ROM/Cache/WebTVLogoJewel.gif" width=87 height=67>
</div>

<div id=topTVBannerShadow>
	<img src=images/TVMailShadowHoriz.gif shadow=#000000 transparency=60>
</div>

<div id=tvPageTitleText>
	<shadow>Type your password</shadow>
</div>

<div id=passwdLabelText>
	Password
</div>

<form name="passwordform">
	<div id=passwdValueText>
		<input type=password bgcolor=191919
			cursor=#cc9933
			text="E7CE4A"
			font=proportional
			name=passwd
			value=""
			size=18
			maxlength=40
			width=230
			autoactivate
			selected
			nosubmit>
	</div>

	<div id=doneButton>
		<font size=-1 color=#ffcf69><shadow>
		<input type=submit value=Done name=Done
			usestyle width=135 action="" onClick='CheckPassword();'
			borderimage=file://ROM/tvimages/TVButtonBorder.bif>
		</shadow></font>
	</div>
</form>

</body>
</html>
